{% extends 'base_dashboard.html' %}
{% load static %}

{% block title %}Admin Dashboard | IG Mobile{% endblock %}

{% block breadcrumb %}
    <span class="current">Admin Dashboard</span>
{% endblock %}

{% block page_title %}Admin Dashboard{% endblock %}
{% block page_description %}System overview and administrative controls{% endblock %}

{% block sidebar_menu %}
    <div class="menu-label">Admin</div>
    <a href="{% url 'adminDashboard' %}" class="menu-item active">
        <i class="fas fa-tachometer-alt"></i>
        <span>Dashboard</span>
    </a>
{#    <a href="{% url 'employee_management' %}" class="menu-item">#}
        <i class="fas fa-users"></i>
        <span>Employee Management</span>
    </a>
{#    <a href="{% url 'roles_permissions' %}" class="menu-item">#}
        <i class="fas fa-user-shield"></i>
        <span>Roles & Permissions</span>
    </a>

    <div class="menu-label">Inventory</div>
{#    <a href="{% url 'product_categories' %}" class="menu-item">#}
        <i class="fas fa-tags"></i>
        <span>Categories</span>
    </a>
{#    <a href="{% url 'product_management' %}" class="menu-item">#}
        <i class="fas fa-mobile-alt"></i>
        <span>Products</span>
    </a>

    <div class="menu-label">Business</div>
{#    <a href="{% url 'supplier_management' %}" class="menu-item">#}
        <i class="fas fa-truck"></i>
        <span>Suppliers</span>
    </a>
{#    <a href="{% url 'purchase_orders' %}" class="menu-item">#}
        <i class="fas fa-shopping-cart"></i>
        <span>Purchase Orders</span>
    </a>
{#    <a href="{% url 'sales_history' %}" class="menu-item">#}
        <i class="fas fa-chart-line"></i>
        <span>Sales History</span>
    </a>

    <div class="menu-label">Reports</div>
{#    <a href="{% url 'sales_reports' %}" class="menu-item">#}
        <i class="fas fa-chart-bar"></i>
        <span>Sales Reports</span>
    </a>
{#    <a href="{% url 'inventory_reports' %}" class="menu-item">#}
        <i class="fas fa-boxes"></i>
        <span>Inventory Reports</span>
    </a>
{#    <a href="{% url 'financial_reports' %}" class="menu-item">#}
        <i class="fas fa-rupee-sign"></i>
        <span>Financial Reports</span>
    </a>

    <div class="menu-label">Settings</div>
{#    <a href="{% url 'system_settings' %}" class="menu-item">#}
        <i class="fas fa-cog"></i>
        <span>System Settings</span>
    </a>
{#    <a href="{% url 'backup_restore' %}" class="menu-item">#}
        <i class="fas fa-database"></i>
        <span>Backup & Restore</span>
    </a>
{% endblock %}

{% block content %}
    <!-- Key Metrics -->
    <div class="metrics-grid">
        <div class="metric-card">
            <div class="metric-header">
                <h3 class="metric-title">Total Revenue</h3>
                <div class="metric-icon blue">
                    <i class="fas fa-rupee-sign"></i>
                </div>
            </div>
            <h2 class="metric-value">₹{{ total_revenue|default:"0" }}</h2>
            <div class="metric-change positive">
                <i class="fas fa-arrow-up mr-1"></i> 12% from last month
            </div>
        </div>

        <div class="metric-card">
            <div class="metric-header">
                <h3 class="metric-title">Total Sales</h3>
                <div class="metric-icon green">
                    <i class="fas fa-shopping-cart"></i>
                </div>
            </div>
            <h2 class="metric-value">{{ total_sales|default:"0" }}</h2>
            <div class="metric-change positive">
                <i class="fas fa-arrow-up mr-1"></i> 8% from last month
            </div>
        </div>

        <div class="metric-card">
            <div class="metric-header">
                <h3 class="metric-title">Total Products</h3>
                <div class="metric-icon orange">
                    <i class="fas fa-boxes"></i>
                </div>
            </div>
            <h2 class="metric-value">{{ product_count|default:"0" }}</h2>
            <div class="metric-change negative">
                <i class="fas fa-arrow-down mr-1"></i> 3% from last month
            </div>
        </div>

        <div class="metric-card">
            <div class="metric-header">
                <h3 class="metric-title">Total Employees</h3>
                <div class="metric-icon red">
                    <i class="fas fa-users"></i>
                </div>
            </div>
            <h2 class="metric-value">{{ employee_count|default:"0" }}</h2>
            <div class="metric-change positive">
                <i class="fas fa-arrow-up mr-1"></i> 5% from last month
            </div>
        </div>
    </div>

    <!-- Charts Row -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
        <div class="chart-card">
            <div class="chart-header">
                <h3 class="chart-title">Revenue Overview</h3>
                <div class="chart-actions">
                    <select class="text-sm border rounded p-1 date-range-selector">
                        <option>Last 7 Days</option>
                        <option>Last 30 Days</option>
                        <option>Last 90 Days</option>
                    </select>
                </div>
            </div>
            <div class="chart-body">
                <canvas id="revenueChart"></canvas>
            </div>
        </div>

        <div class="chart-card">
            <div class="chart-header">
                <h3 class="chart-title">Sales by Category</h3>
                <div class="chart-actions">
                    <select class="text-sm border rounded p-1 date-range-selector">
                        <option>This Month</option>
                        <option>Last Month</option>
                        <option>This Year</option>
                    </select>
                </div>
            </div>
            <div class="chart-body">
                <canvas id="categoriesChart"></canvas>
            </div>
        </div>
    </div>

    <!-- Tables & Activity Row -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Recent Orders Table -->
        <div class="lg:col-span-2">
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">Recent Orders</h3>
{#                    <a href="{% url 'sales_history' %}" class="text-sm text-blue-500 hover:underline">View All</a>#}
                </div>
                <div class="p-4">
                    <table class="data-table">
                        <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Customer</th>
                            <th>Date</th>
                            <th>Amount</th>
                            <th>Status</th>
                        </tr>
                        </thead>
                        <tbody>
                        {% if recent_sales %}
                            {% for sale in recent_sales %}
                                <tr>
                                    <td>#{{ sale.sale_id }}</td>
                                    <td>{{ sale.customer_id.customer_name }}</td>
                                    <td>{{ sale.sale_date|date:"M d, Y" }}</td>
                                    <td>₹{{ sale.total_amount }}</td>
                                    <td>
                                        <span class="status success">
                                            Completed
                                        </span>
                                    </td>
                                </tr>
                            {% endfor %}
                        {% else %}
                            <tr>
                                <td colspan="5" class="text-center py-4">No recent orders found</td>
                            </tr>
                        {% endif %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Activity Feed -->
        <div class="activity-card">
            <div class="activity-card-header">
                <h3 class="activity-card-title">Recent Activities</h3>
            </div>
            <ul class="activity-list">
                {% if recent_activities %}
                    {% for activity in recent_activities %}
                        <li class="activity-item">
                            <div class="activity-icon {% if activity.action_type == 'create' %}green{% elif activity.action_type == 'update' %}blue{% elif activity.action_type == 'delete' %}red{% else %}blue{% endif %}">
                                {% if activity.action_type == 'create' %}
                                    <i class="fas fa-plus"></i>
                                {% elif activity.action_type == 'update' %}
                                    <i class="fas fa-edit"></i>
                                {% elif activity.action_type == 'delete' %}
                                    <i class="fas fa-trash"></i>
                                {% elif activity.action_type == 'login' %}
                                    <i class="fas fa-sign-in-alt"></i>
                                {% else %}
                                    <i class="fas fa-info-circle"></i>
                                {% endif %}
                            </div>
                            <div class="activity-content">
                                <p class="activity-title">{{ activity.action }}</p>
                                <p class="activity-time">{{ activity.date|timesince }} ago</p>
                            </div>
                        </li>
                    {% endfor %}
                {% else %}
                    <li class="activity-item">
                        <div class="activity-content">
                            <p class="activity-title">No recent activities</p>
                        </div>
                    </li>
                {% endif %}
            </ul>
        </div>
    </div>
{% endblock %}